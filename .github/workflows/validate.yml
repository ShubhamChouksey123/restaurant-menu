name: Validate Files

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]
  workflow_dispatch:

jobs:
  validate:
    name: Validate Project
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check required files
        run: |
          echo "=== Checking Required Files ==="

          # Check index.html
          if [ -f "index.html" ]; then
            echo "✅ index.html exists"
          else
            echo "❌ index.html missing"
            exit 1
          fi

          # Check CSS
          if [ -f "static/css/styles.css" ]; then
            echo "✅ styles.css exists"
          else
            echo "❌ styles.css missing"
            exit 1
          fi

          # Check JS
          if [ -f "static/js/script.js" ]; then
            echo "✅ script.js exists"
          else
            echo "❌ script.js missing"
            exit 1
          fi

          # Check images directory
          if [ -d "static/images/dishes" ]; then
            echo "✅ images directory exists"
          else
            echo "❌ images directory missing"
            exit 1
          fi

      - name: Count images
        run: |
          echo "=== Counting Images ==="

          if [ -d "static/images/dishes" ]; then
            count=$(find static/images/dishes -type f \( -name "*.jpg" -o -name "*.jpeg" -o -name "*.png" \) | wc -l)
            echo "Found $count images"

            if [ $count -gt 50 ]; then
              echo "✅ Sufficient images found"
            else
              echo "⚠️ Warning: Only $count images found"
            fi
          fi

      - name: Validate HTML structure
        run: |
          echo "=== Validating HTML ==="

          if grep -q "<html" index.html && grep -q "</html>" index.html; then
            echo "✅ HTML tags OK"
          else
            echo "❌ Invalid HTML structure"
            exit 1
          fi

          if grep -q "<title>" index.html; then
            echo "✅ Title tag present"
          else
            echo "⚠️ No title tag"
          fi

      - name: Check file references
        run: |
          echo "=== Checking File References ==="

          if grep -q 'styles.css' index.html; then
            echo "✅ CSS referenced in HTML"
          fi

          if grep -q 'script.js' index.html; then
            echo "✅ JS referenced in HTML"
          fi

      - name: Summary
        run: |
          echo "=== Validation Complete ==="
          echo "✅ All critical checks passed"
